<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="UTF-8">
	<title>Title</title>
	<script>
        /*
		 	ex_06 todolist ì—ì„œ ì¶”ê°€
		 	- ì²´í¬ë°•ìŠ¤ ì†ì„±ì„ ì¶”ê°€í•´ ì²´í¬ë¥¼ í•˜ê²Œë˜ë©´ ë°”ë¡œ ì‚­ì œê°€ ë˜ë„ë¡!

		 	* ì°¸ê³ : localStorage ê³µê°„ì´ ex_06ì™€ ê°™ì•„ì„œ ë°ì´í„° ì—°ë™ë˜ì–´ìˆìŒ!
	    */
        document.addEventListener("DOMContentLoaded", function () {
            const input = document.getElementById('todoInput'); // í…ìŠ¤íŠ¸ ìƒì
            const addButton = document.getElementById('addButton'); // ì¶”ê°€ ë²„íŠ¼
            const clearButton = document.getElementById('clearButton'); // ì„ íƒ ì‚­ì œ ë²„íŠ¼
            const clearAllButton = document.getElementById('clearAllButton'); // ëª¨ë‘ ì‚­ì œ ë²„íŠ¼
            const todoList = document.getElementById('todoList'); // ë¦¬ìŠ¤íŠ¸

            // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
            let list = JSON.parse(localStorage.getItem('TodoList')) || []; // JSON ì´ null ì´ë©´ ë¹ˆë°°ì—´ ìƒì„±

            // ë°ì´í„° ì°¾ê¸°
            const findData = (value) => {
                let isData = false;
                list.forEach((item) => {
                    if (item === value) {
                        isData = true; // ê°’ì´ ì¡´ì œí•˜ë©´ true ë¡œ ë³€ê²½
                    }
                });
                return isData;
            }

            // ì²´í¬ ë°•ìŠ¤ ì„ íƒìœ ë¬´ ìŠ¤íƒ€ì¼ ë³€ê²½
            const checkBoxToggle = (li) =>{
                li.querySelector('input').addEventListener('change', (e) => {
                    if (e.target.checked === true) { // íƒìŠ¤íŠ¸ ìƒìê°€ ì²´í¬ëœ ê²½ìš°
                        li.style.textDecorationLine = 'line-through';
                        li.style.fontStyle = 'italic';
                        li.style.color = '#b3b3b3';
                        return;
                    }
                    // í…ìŠ¤íŠ¸ ìƒìê°€ ì²´í¬ë˜ì§€ ì•Šì€ ê²½ìš°
                    li.style.fontStyle = 'normal';
                    li.style.textDecoration = 'none';
                    li.style.color ='black';
                });
			}

            // ë°ì´í„° ë¦¬ìŠ¤íŠ¸ ì¶œë ¥
            const showList = () => {
                // ê¸°ì¡´ ë°ì´í„°ë¡œ í™”ë©´ì— li ì¶”ê°€
                list.forEach((item,index) => {
                    const li = document.createElement('li');
                    li.innerHTML = `<input type="checkbox" id="checkBox" data-idx="${index}"> ${item}`;
                    checkBoxToggle(li); // ì²´í¬ ë°•ìŠ¤ ì„ íƒì— ë”°ë¥¸ ìŠ¤íƒ€ì¼ ë³€ê²½
                    todoList.appendChild(li);
                });
            }

            // Add ë²„íŠ¼ í´ë¦­ ì‹œ
            addButton.addEventListener('click', function () {
                const value = input.value.trim(); // ë¹ˆì¹¸ì œê±° í›„ ì €ì¥
                // ì˜ˆì™¸ì²˜ë¦¬: ë¦¬ìŠ¤íŠ¸ì— ì´ë¯¸ ì¡´ì œí•˜ëŠ” ê²½ìš°
				if (findData(value)) {
					alert('ë¦¬ìŠ¤íŠ¸ê°€ ì´ë¯¸ ì¡´ì œí•©ë‹ˆë‹¤!');
                    return;
                }
                // ì˜ˆì™¸ì²˜ë¦¬: íƒìŠ¤íŠ¸ìƒìì— ê°’ì´ ì—†ëŠ”ê²½ìš°
                if (value === ''){
                    alert('ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                    return;
                }
                const li = document.createElement('li');
                li.innerHTML = `<input type="checkbox" id="checkBox" data-idx="${list.length}"> ${value}`; // ì¸ë±ìŠ¤ ë²ˆí˜¸ ì¶”ê°€ë¥¼ ìœ„í•´ data-idx ì¶”ê°€
                checkBoxToggle(li); // ì²´í¬ ë°•ìŠ¤ ì„ íƒì— ë”°ë¥¸ ìŠ¤íƒ€ì¼ ë³€ê²½
                todoList.appendChild(li);
                list.push(value); //ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€
                localStorage.setItem('TodoList', JSON.stringify(list)); //ë¦¬ìŠ¤íŠ¸ ì—…ê·¸ë ˆì´ë“œ
                console.log(`updated :) [ ADD: ${value} (${li.querySelector('input').getAttribute('data-idx')})]`);
                input.value = ''; // íƒìŠ¤íŠ¸ìƒì ë¹„ìš°ê¸°
            });

            // Clear ë²„íŠ¼ í´ë¦­ì‹œ
            clearButton.addEventListener('click', function () {
                const value = input.value.trim(); // íƒìŠ¤íŠ¸ ìƒìì— ì…ë ¥ëœ ê°’ì„ ë¶ˆëŸ¬ì˜´
                // ì˜ˆì™¸ì²˜ë¦¬: íƒìŠ¤íŠ¸ìƒìì— ê°’ì´ ì—†ëŠ”ê²½ìš°
                if (value === ''){
                    alert('ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!');
                    return;
                }
                // ê°’ì´ ì¡´ì œí•˜ëŠ” ê²½ìš° ì œê±°
                if(findData(value)){
                    list.splice(list.indexOf(value), 1);
                    localStorage.setItem('TodoList',JSON.stringify(list));
                    console.log(`updated :) [ DELETE: ${value}]`);
                    input.value = '';
                    todoList.innerHTML =''; // ê¸°ì¡´ li ì œê±°
                    showList(); // ë¦¬ìŠ¤íŠ¸ ì¬ì¶œë ¥
                    return;
			   }
                alert(`${value}ê°€ ë¦¬ìŠ¤íŠ¸ì— ì¡´ì œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤!`);
            });

            // ClearAll ë²„íŠ¼ í´ë¦­ ëª¨ë‘ ì‚­ì œ
            clearAllButton.addEventListener('click', function () {
                if(confirm('ì •ë§ ëª¨ë‘ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? \nì‚­ì œí›„ì—ëŠ” ë³µêµ¬ í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')){
                    // ìš”ì†Œ ì´ˆê¸°í™”
                    localStorage.clear();
                    todoList.innerHTML = '';
                    list = [];
                    input.value = '';
                    alert("ëª¨ë‘ ì‚­ì œ ë˜ì—ˆìŠµë‹ˆë‹¤!");
                    console.log(`successfully cleared :)`);
				}
            });

			showList();
        });
	</script>
	<style>
		body{
			display: flex;
			flex-direction: column;
			align-items: center;
			justify-content: center;
			background-color: #aacaef;
		}
		h1{
			font-size: 44px;
		}

		div input{
			width: 500px;
			height: 50px;
			border-radius: 10px;
			text-align: center;
			font-size: 20px;
		}
		div button{
			width: 100px;
			height: 50px;
			text-align: center;
			border-radius: 5px;
        }

		ul{
			background-color: white ;
			width: 1000px;
			height: 700px;
			overflow-y: scroll;
			padding: 20px;
			display: flex;
			flex-direction: column;
			align-items: center;
		}
		li{
			list-style: none;
			font-size: 30px;
		}

		input[type="checkbox"]{
			width: 20px;
			height: 20px;
		}



	</style>
</head>
<body>
<h1>My To-Do List</h1>
<div>
	<label for="todoInput"></label><input type="text" id="todoInput" placeholder="Add a new task">
	<button id="addButton">â•Add</button>
	<button id="clearButton">ğŸ”Clear</button>
	<button id="clearAllButton">âŒClear All</button>
</div>
<ul id="todoList"></ul>
</body>
</html>